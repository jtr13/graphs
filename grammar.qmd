# Grammar of graphics

```{r}
#| echo: false
#| fig-height: 3

library(patchwork)

bg_color <- "#ffe79b"
text_color <- "#af2e2f"
line_color <- "white"
fs <- 13

options(tidyverse.quiet = TRUE)
library(tidyverse)
df <- data.frame(state.x77) |> 
  rownames_to_column("State") |> 
  mutate(Region = state.region)

p1 <- ggplot(df, aes(Income, Illiteracy)) +
  geom_point(color = "#0099FF") + 
  theme_void() + 
  ggtitle("Layer(s)")

p2 <- ggplot(df, aes(Income, Illiteracy/100)) +
  theme_classic(fs) + 
  ggtitle("Scales") +
  scale_x_continuous() + 
  scale_y_continuous(name = "Illiteracy", labels = scales::percent)

p3 <- ggplot(df, aes(Income, Illiteracy/100)) +
  scale_x_continuous(name = NULL) +
  scale_y_continuous(name = NULL) +
  ggtitle("Coordinate System") +
  theme_bw(fs) +
  theme(axis.text = element_blank())

p4 <- ggplot(df, aes(Income, Illiteracy/100)) +
  scale_x_continuous(name = NULL) +
  scale_y_continuous(name = NULL) +
  ggtitle("Faceting") +
  theme_bw(fs) +
  theme(axis.text = element_blank()) +
  facet_wrap(~Region)


p5 <- ggplot(df, aes(Income, Illiteracy/100)) +
  ggtitle("Theme") +
  theme_void(fs) + 
  theme(title = element_text(family = "mono", color = text_color),
        panel.background  = element_rect(fill = bg_color),
        panel.grid.major.y = element_line(color = line_color),
        panel.grid.minor.y = element_line(color = line_color),
        axis.text = element_text(color = "white"))

p1 + p2 + p3
plot_spacer() + p4 + p5 + plot_spacer() + 
  plot_layout(widths = c(.5, 1, 1, .5))
```

